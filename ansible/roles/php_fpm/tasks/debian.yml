---
# PHP installation for Debian
# Uses sury.org repository for latest PHP versions

- name: Install dependencies
  ansible.builtin.apt:
    name:
      - apt-transport-https
      - lsb-release
      - ca-certificates
      - wget
    state: present

- name: Add sury.org PHP repository GPG key
  ansible.builtin.apt_key:
    url: "https://packages.sury.org/php/apt.gpg"
    state: present
  when: php_version | float > 8.2

- name: Add sury.org PHP repository
  ansible.builtin.apt_repository:
    repo: "deb https://packages.sury.org/php/ {{ ansible_distribution_release }} main"
    state: present
    filename: php-sury
    update_cache: true
  when: php_version | float > 8.2
