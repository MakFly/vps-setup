---
import { getCollection, render } from "astro:content";
import DocsLayout from "@/layouts/DocsLayout.astro";
import { getDocsForLocale } from "@/lib/docs";

export async function getStaticPaths() {
  const docs = await getDocsForLocale("en");
  return docs.map((doc, index) => {
    const slug = doc.id.replace("en/", "");
    const prev = index > 0 ? docs[index - 1] : null;
    const next = index < docs.length - 1 ? docs[index + 1] : null;
    return {
      params: { slug },
      props: {
        entry: doc,
        prevPage: prev ? { title: prev.data.title, slug: prev.id.replace("en/", "") } : null,
        nextPage: next ? { title: next.data.title, slug: next.id.replace("en/", "") } : null,
      },
    };
  });
}

const { entry, prevPage, nextPage } = Astro.props;
const { Content, headings } = await render(entry);
---

<DocsLayout
  title={entry.data.title}
  description={entry.data.description}
  headings={headings}
  prevPage={prevPage}
  nextPage={nextPage}
>
  <Content />
</DocsLayout>
